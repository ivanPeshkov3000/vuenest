### Первые шаги

В этом цикле статей вы изучите **фундаментальные основы** NestJS.

Чтобы ознакомиться с основными строительными блоками приложений на Nest, мы создадим базовое CRUD-приложение с функциями, которые охватывают множество вопросов начального уровня.

#### Язык

Мы влюблены в [TypeScript](https://www.typescriptlang.org/), но прежде всего - мы любим [Node.js](https://nodejs.org/en/). Вот почему Nest совместим как с TypeScript, так и с **чистым JavaScript**. NestJS использует новейшие возможности языка, поэтому для использования его с ванильным JavaScript нам нужен компилятор [Babel](https://babeljs.io/).

В приведенных примерах мы в основном будем использовать TypeScript, но вы всегда можете **переключить фрагменты кода** на синтаксис ванильного JavaScript (просто нажмите, чтобы переключить кнопку языка в правом верхнем углу каждого фрагмента).

#### Предварительные требования

Пожалуйста, убедитесь, чтов в вашей операционной системе устанавливается [Node.js](https://nodejs.org/) (> = 10.13.0, за исключением версии 13).

#### Установка

Настройка нового проекта довольно проста с помощью [Nest CLI](/cli/overview). С установленным [npm](https://www.npmjs.com/) вы можете создать новый проект Nest с помощью следующих команд в вашем терминале операционной системы:

```bash
$ npm i -g @nestjs/cli
$ nest new project-name
```

Будет создан каталог `project-name`, установлены модули в node_modules и несколько других стандартных файлов, а также будет создан каталог `src/`, который будет заполнен несколькими основными файлами:

<div class="file-tree">
  <div class="item">src</div>
  <div class="children">
    <div class="item">app.controller.spec.ts</div>
    <div class="item">app.controller.ts</div>
    <div class="item">app.module.ts</div>
    <div class="item">app.service.ts</div>
    <div class="item">main.ts</div>
  </div>
</div>

Краткий обзор этих основных файлов:

|||
| --- | --- |
| `app.controller.ts`      | Базовый контроллер с одним маршрутом.                                                                             |
| `app.controller.spec.ts` | Модульные тесты для контроллера.                                                                                  |
| `app.module.ts`          | Корневой модуль приложения.                                                                                 |
| `app.service.ts`         | Базовый сервис с одним методом.                                                                               |
| `main.ts`                | Входной файл приложения, который использует основную функцию `NestFactory` для создания экземпляра приложения Nest. |

`main.ts` включает в себя функцию async, которая будет **запускать** наше приложение:

```typescript
@@filename(main)

import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  await app.listen(3000);
}
bootstrap();
@@switch
import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  await app.listen(3000);
}
bootstrap();
```

Для создания экземпляра приложения NestJS мы используем класс `NestFactory`. `NestFactory` предоставляет несколько статических методов, которые позволяют создавать экземпляр приложения. Метод `create()` возвращает объект приложения, который реализует интерфейс `INestApplication`. Этот объект предоставляет набор методов, которые описаны в следующих главах. В приведенном выше примере файла `main.ts` мы просто запускаем наш HTTP-слушатель, который позволяет приложению ожидать входящие HTTP-запросы.

Обратите внимание, что проект, созданный с помощью Nest CLI, генерирует начальную структуру папок, которая побуждает разработчиков следовать соглашению о хранении каждого модуля в его собственном отдельном каталоге.

> **Совет:** По умолчанию, если при создании приложения произойдет какая-либо ошибка, ваше приложение завершит работу с кодом `1`. Если вы хотите, чтобы вместо этого он выдавал ошибку, отключите эту опцию `abortOnError` (например, `NestFactory.create(AppModule, {{ '{' }} abortOnError: false {{ '}' }})`).

#### Платформа

NestJS стремится быть платформо-независимым фреймворком. Независимость от платформы позволяет создавать переиспользуемые логические части, которые разработчики могут применять в различных типах приложений. Технически Nest может работать с любой HTTP-платформой Node.js при создании адаптера. Из коробки поддерживаются две платформы HTTP: [express](https://expressjs.com/) и [fastify](https://www.fastify.io). Вы можете выбрать тот, который лучше всего соответствует вашим требованиям.

|||
| --- | --- |
| `platform-express` | [Express](https://expressjs.com/) - это хорошо известный минималистичный веб-фреймворк для node. Это проверенная в боях, готовая к работе библиотека с большим количеством ресурсов, реализованных сообществом. Пакет `@nestjs/platform-express` используется по умолчанию. Многие пользователи хорошо знакомы с Express, и им не нужно совершать какие-либо действия для его подключения. |
| `platform-fastify` | [Fastify](https://www.fastify.io/) - это высокопроизводительная платформа с низкими накладными расходами, ориентированная на обеспечение максимальной эффективности и скорости. Прочитайте, как ее использовать, [здесь](/techniques/performance). |

Какая бы платформа ни использовалась, она предоставляет свой собственный интерфейс. Они рассматриваются соответственно как `NestExpressApplication` и `NestFastifyApplication`.

Когда вы передаете методу `NestFactory.create()` тип, как в примере ниже, объект `app` будет иметь методы, доступные исключительно для этой конкретной платформы. Обратите внимание, что вам **не нужно** указывать тип, **если** вы на самом деле не хотите получить доступ к базовому API платформы.

```typescript
const app = await NestFactory.create<NestExpressApplication>(AppModule);
```

#### Запуск приложения

После завершения процесса установки вы можете запустить следующую команду в командной строке вашей ОС, чтобы запустить приложение, отслеживающее входящие HTTP-запросы:

```bash
$ npm run start
```

Эта команда запускает приложение на HTTP-сервере, слушающим порт указанный в `src/main.ts` файле. После запуска приложения откройте браузер и перейдите к `http://localhost:3000/`. Вы должны увидеть `Hello World!` сообщение.

Чтобы отслеживать изменения в ваших файлах, вы можете использовать следующую команду для запуска приложения:

```bash
$ npm run start:dev
```

Эта команда будет просматривать ваши файлы, автоматически перекомпилируя и перезагружая сервер.